<?xml version="1.0"?>
<configuration>
	<system.web>
		<compilation debug="true">
			<buildProviders>
				<add extension=".html" type="System.Web.Compilation.PageBuildProvider"/>
			</buildProviders>
		</compilation>
		<customErrors mode="Off" />
		<httpRuntime maxRequestLength="4096" targetFramework="4.8" />
	</system.web>

	<system.webServer>
		<staticContent>
			<!-- Remove inherited MIME types first -->
			<remove fileExtension=".html" />
			<remove fileExtension=".css" />
			<remove fileExtension=".js" />
			<remove fileExtension=".json" />
			<remove fileExtension=".webp" />

			<!-- Add corrected MIME mappings -->
			<mimeMap fileExtension=".html" mimeType="text/html" />
			<mimeMap fileExtension=".css" mimeType="text/css" />
			<mimeMap fileExtension=".js" mimeType="application/javascript" />
			<mimeMap fileExtension=".json" mimeType="application/json" />
			<mimeMap fileExtension=".webp" mimeType="image/webp" />
		</staticContent>

		<httpProtocol>
			<customHeaders>
				<remove name="X-Powered-By"/>
				<add name="X-Content-Type-Options" value="nosniff"/>
				<add name="X-Frame-Options" value="SAMEORIGIN"/>
				<add name="Referrer-Policy" value="strict-origin-when-cross-origin"/>
				<add name="Access-Control-Allow-Origin" value="https://yourdomain.com" />
				<add name="Access-Control-Allow-Methods" value="GET,POST" />
			</customHeaders>
		</httpProtocol>

		<rewrite>
			<rules>
				<rule name="Redirect ASPX to HTML" stopProcessing="true">
					<match url="^(.*)\.aspx$"/>
					<action type="Redirect" url="{R:1}.html" redirectType="Permanent"/>
				</rule>
				<rule name="SPA Fallback" stopProcessing="true">
					<match url=".*"/>
					<conditions logicalGrouping="MatchAll">
						<add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
						<add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true"/>
					</conditions>
					<action type="Rewrite" url="/index.html"/>
				</rule>
			</rules>
		</rewrite>

		<defaultDocument>
			<files>
				<clear/>
				<add value="index.html"/>
			</files>
		</defaultDocument>

		<httpErrors errorMode="Custom" existingResponse="Replace">
			<remove statusCode="404"/>
			<error statusCode="404" path="/404.html" responseMode="ExecuteURL"/>
		</httpErrors>
	</system.webServer>

	<runtime>
		<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
			<dependentAssembly>
				<assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-13.0.0.0" newVersion="13.0.0.0"/>
			</dependentAssembly>
		</assemblyBinding>
	</runtime>
</configuration>